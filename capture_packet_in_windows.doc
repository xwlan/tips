Windows has several inbox components capable of packet capture:

"pktmon" is implemented as an integral part of the Windows operating system. It's capable of capturing packets 
in many components of the operating system, giving full visibility into the life of the packet as it traverses the system. A capture can be collected with:

method 1:
pktmon start --capture
<repro>
pktmon stop


method 2:
"ndiscap" which is implemented as an ETW trace provider. A capture can be collected with:
netsh trace start capture=yes report=disabled
<repro>
netsh trace stop

The files generated by these tools are etl files, which can be opened by ETW-centric tools like Microsoft Message Analyzer, 
but cannot be opened by Wireshark, which is the preferred tool for many engineers. Etl2pcapng.exe can convert the etl file 
to a pcapng file for opening with Wireshark, or for analysis with languages that have pcapng libraries available such as Python and Rust.

Note: pktmon has a built-in etl2pcap conversion utility ("pktmon etl2pcap <filename>") which is also capable of producing basic pcapng files. 
etl2pcapng provides a similar conversion capability to the built-in utility with the following additions:

Preserving all used components as pcapng interfaces.
Providing additional information about each interface in the interface description block such as the Name, Description, 
IP address (IPv4 and IPv6), and MAC address when available.Preserving pktmon pktgroupid on each packet for correlating 
multiple appearances of the same packet. This is stored in the PacketId option field of the enhanced packet block.
Marking packets dropped by the operating system in the verdict option field of the enhanced packet block.Outputting 
additional trace provider messages as systemd journal export blocks.
